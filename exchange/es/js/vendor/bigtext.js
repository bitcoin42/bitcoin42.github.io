/*!
 * BigText - v1.0.0 - 2017-06-01
 * A jQuery plugin, calculates the font-size and word-spacing needed to match a line of text to a specific width.
 * Copyright (c) 2017 Zach Leatherman (@zachleat)  MIT License
 * URL:    https://github.com/zachleat/BigText
*/
!function(e,t){"use strict";var i=0,n=t("head"),s=e.BigText,r=t.fn.bigtext,o={DEBUG_MODE:!1,DEFAULT_MIN_FONT_SIZE_PX:null,DEFAULT_MAX_FONT_SIZE_PX:528,GLOBAL_STYLE_ID:"bigtext-style",STYLE_ID:"bigtext-id",LINE_CLASS_PREFIX:"bigtext-line",EXEMPT_CLASS:"bigtext-exempt",noConflict:function(i){return i&&(t.fn.bigtext=r,e.BigText=s),o},supports:{wholeNumberFontSizeOnly:function(){if(!("getComputedStyle"in e))return!0;var i=t("<div/>").css({position:"absolute","font-size":"14.1px"}).insertBefore(t("script").eq(0)),n=e.getComputedStyle(i[0],null),s=n&&"14px"===n.getPropertyValue("font-size");return i.remove(),s}()},init:function(){t("#"+o.GLOBAL_STYLE_ID).length||n.append(o.generateStyleTag(o.GLOBAL_STYLE_ID,[".bigtext * { white-space: nowrap; } .bigtext > * { display: block; }",".bigtext ."+o.EXEMPT_CLASS+", .bigtext ."+o.EXEMPT_CLASS+" * { white-space: normal; }"]))},bindResize:function(i,n){var s;t(e).unbind(i).bind(i,function(){s&&clearTimeout(s),s=setTimeout(n,100)})},getStyleId:function(e){return o.STYLE_ID+"-"+e},generateStyleTag:function(e,i){return t("<style>"+i.join("\n")+"</style>").attr("id",e)},clearCss:function(e){var i=o.getStyleId(e);t("#"+i).remove()},generateCss:function(e,t,i,n){var s=[];o.clearCss(e);for(var r=0,a=t.length;r<a;r++)s.push("#"+e+" ."+o.LINE_CLASS_PREFIX+r+" {"+(n[r]?" white-space: normal;":"")+(t[r]?" font-size: "+t[r]+"px;":"")+(i[r]?" word-spacing: "+i[r]+"px;":"")+"}");return o.generateStyleTag(o.getStyleId(e),s)},jQueryMethod:function(e){return o.init(),e=t.extend({minfontsize:o.DEFAULT_MIN_FONT_SIZE_PX,maxfontsize:o.DEFAULT_MAX_FONT_SIZE_PX,childSelector:"",resize:!0},e||{}),this.each(function(){var s=t(this).addClass("bigtext"),r=s.width(),a=s.attr("id"),c=e.childSelector?s.find(e.childSelector):s.children();a||(a="bigtext-id"+i++,s.attr("id",a)),e.resize&&o.bindResize("resize.bigtext-event-"+a,function(){o.jQueryMethod.call(t("#"+a),e)}),o.clearCss(a),c.addClass(function(e,t){return[t.replace(new RegExp("\\b"+o.LINE_CLASS_PREFIX+"\\d+\\b"),""),o.LINE_CLASS_PREFIX+e].join(" ")});var l=o.calculateSizes(s,c,r,e.maxfontsize,e.minfontsize);n.append(o.generateCss(a,l.fontSizes,l.wordSpacings,l.minFontSizes))}),this.trigger("bigtext:complete")},testLineDimensions:function(e,t,i,n,s,r,o){var a;if(o="number"==typeof o?o:0,e.css(i,n+r),(a=e.width())>=t){if(e.css(i,""),a===t)return{match:"exact",size:parseFloat((parseFloat(n)-.1).toFixed(3))};var c=t-o,l=a-t;return{match:"estimate",size:parseFloat((parseFloat(n)-("word-spacing"===i&&o&&l<c?0:s)).toFixed(3))}}return a},calculateSizes:function(e,i,n,s,r){var a=e.clone(!0).addClass("bigtext-cloned").css({fontFamily:e.css("font-family"),textTransform:e.css("text-transform"),wordSpacing:e.css("word-spacing"),letterSpacing:e.css("letter-spacing"),position:"absolute",left:o.DEBUG_MODE?0:-9999,top:o.DEBUG_MODE?0:-9999}).appendTo(document.body),c=[],l=[],u=[],p=[];return i.css("float","left").each(function(){var e,i,a=t(this),l=o.supports.wholeNumberFontSizeOnly?[8,4,1]:[8,4,1,.1];if(a.hasClass(o.EXEMPT_CLASS))return c.push(null),p.push(null),void u.push(!1);var f=parseFloat(a.css("font-size")),d=(a.width()/f).toFixed(6);i=parseInt(n/d,10)-32;e:for(var g=0,S=l.length;g<S;g++)t:for(var h=1;h<=10;h++){if(i+h*l[g]>s){i=s;break e}if("number"!=typeof(e=o.testLineDimensions(a,n,"font-size",i+h*l[g],l[g],"px",e))){if(i=e.size,"exact"===e.match)break e;break t}}p.push(n/i),i>s?(c.push(s),u.push(!1)):r&&i<r?(c.push(r),u.push(!0)):(c.push(i),u.push(!1))}).each(function(e){var i,s=t(this),r=0;if(s.hasClass(o.EXEMPT_CLASS))l.push(null);else{s.css("font-size",c[e]+"px");for(var a=1;a<3;a+=1)if("number"!=typeof(i=o.testLineDimensions(s,n,"word-spacing",a,1,"px",i))){r=i.size;break}s.css("font-size",""),l.push(r)}}).removeAttr("style"),o.DEBUG_MODE?a.css({"background-color":"rgba(255,255,255,.4)"}):a.remove(),{fontSizes:c,wordSpacings:l,ratios:p,minFontSizes:u}}};t.fn.bigtext=o.jQueryMethod,e.BigText=o}(this,jQuery);
